(this["webpackJsonpdata-collector"]=this["webpackJsonpdata-collector"]||[]).push([[0],{120:function(e,a,t){e.exports=t(148)},125:function(e,a,t){},148:function(e,a,t){"use strict";t.r(a);var n,l=t(0),r=t.n(l),c=t(12),o=t.n(c),i=(t(125),t(11)),u=t(178),m=t(198),s=t(182),d=t(191),E=t(184),p=t(98),f=t(174),v=t(196),g=t(194),h=t(181),b=t(200),O=t(195),j=t(202),S=t(183),y=t(15),_=t(192),k=t(96),C=t(83);t.n(C).a.config();var x={appServerUrl:null!==(n=Object({NODE_ENV:"production",PUBLIC_URL:"/kinrai",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0}).APP_SERVER_URL)&&void 0!==n?n:"https://restaurant-recommender-system.et.r.appspot.com"},w=t(27),P=t.n(w),U=t(39),T=t.n(U),W=t(88),R=t.n(W),z=t(87),I=t.n(z),B=function(){var e=Object(l.useState)(!1),a=Object(i.a)(e,2),t=a[0],n=a[1],c=Object(l.useState)(!1),o=Object(i.a)(c,2),d=o[0],C=o[1],w=Object(l.useState)(""),U=Object(i.a)(w,2),W=U[0],z=U[1],B=Object(l.useState)(""),G=Object(i.a)(B,2),L=G[0],D=G[1],F=Object(l.useState)(""),M=Object(i.a)(F,2),K=M[0],N=M[1],A=Object(l.useState)(null),H=Object(i.a)(A,2),V=H[0],J=H[1],$=Object(l.useState)(""),Z=Object(i.a)($,2),q=Z[0],Q=Z[1],X=Object(l.useState)(!1),Y=Object(i.a)(X,2),ee=Y[0],ae=Y[1],te=Object(l.useState)([]),ne=Object(i.a)(te,2),le=ne[0],re=ne[1],ce=Object(l.useState)([]),oe=Object(i.a)(ce,2),ie=oe[0],ue=oe[1],me=Object(l.useState)(0),se=Object(i.a)(me,2),de=se[0],Ee=se[1],pe=Object(l.useState)(0),fe=Object(i.a)(pe,2),ve=fe[0],ge=fe[1],he=Object(l.useState)(!1),be=Object(i.a)(he,2),Oe=be[0],je=be[1];Object(l.useEffect)((function(){var e=[];P.a.get("".concat(x.appServerUrl,"/api/categories/search?is_visible=1&is_common=1")).then((function(a){a.data.forEach((function(a){e.push({value:a._id,label:a.name_en})}));var t=a.data.length;ge(t),P.a.get("".concat(x.appServerUrl,"/api/categories/search?is_visible=1&is_common=0")).then((function(a){a.data.forEach((function(a){e.push({value:a._id,label:a.name_en})})),Ee(t),ue(e),n(!0)}))})).catch((function(e){alert(e.response)}))}),[]);var Se=function(e){je(e),Ee(e?ie.length:ve)};var ye=ie.slice(0,de).map((function(e){var a=e.value,t=e.label;return r.a.createElement(f.a,{control:r.a.createElement(v.a,{checked:le.includes(a),onChange:function(){return function(e){var a=(null===le||void 0===le?void 0:le.includes(e))?null===le||void 0===le?void 0:le.filter((function(a){return a!==e})):[].concat(Object(p.a)(null!==le&&void 0!==le?le:[]),[e]);return re(a),console.log(a),a}(a)},name:a}),key:a,label:t})}));return r.a.createElement("div",null,r.a.createElement("h3",null,"Registration"),t?r.a.createElement("div",null,r.a.createElement(u.a,{fullWidth:!0},r.a.createElement(g.a,{display:"flex",alignItems:"center"},r.a.createElement(g.a,{width:"100%",mr:1},r.a.createElement(m.a,{fullWidth:!0,error:""!==W,helperText:W,value:L,onChange:function(e){var a=e.target.value,t="";a.match(/^[0-9a-zA-Z]+$/)||(t="Cannot contain special charecters."),""===a&&(t="Username cannot be blank."),""===t&&(C(!0),P.a.get("".concat(x.appServerUrl,"/api/users/has/").concat(a)).then((function(e){C(!1),t=e.data?"This name is already existed":"",z(t)}))),z(t),D(a)},variant:"outlined",label:"Username"})),d&&r.a.createElement(g.a,{minWidth:35},r.a.createElement(h.a,{color:"secondary"}))),r.a.createElement("p",null),r.a.createElement(u.a,{variant:"outlined"},r.a.createElement(b.a,null,"Gender"),r.a.createElement(O.a,{variant:"outlined",value:K,onChange:function(e){N(e.target.value)},label:"Gender"},r.a.createElement(j.a,{value:"none"},r.a.createElement("em",null,"Select gender...")),r.a.createElement(j.a,{value:"male"},"Male"),r.a.createElement(j.a,{value:"female"},"Female"))),r.a.createElement(y.a,{utils:k.a},r.a.createElement(_.a,{margin:"normal",inputVariant:"outlined",id:"date-picker-dialog",label:"Birth Date",format:"dd/MM/yyyy",value:V,onChange:function(e){J(e)},KeyboardButtonProps:{"aria-label":"change date"}})),r.a.createElement("h4",null,"Profile"),r.a.createElement(u.a,{variant:"outlined"},r.a.createElement(b.a,{id:"demo-simple-select-filled-label"},"Price Preference"),r.a.createElement(O.a,{labelId:"demo-simple-select-filled-label",variant:"outlined",value:q,onChange:function(e){Q(e.target.value)},label:"Price Preference"},r.a.createElement(j.a,{value:"none"},r.a.createElement("em",null,"Select prefer price...")),r.a.createElement(j.a,{value:1},"\u0e3f"),r.a.createElement(j.a,{value:2},"\u0e3f\u0e3f"),r.a.createElement(j.a,{value:3},"\u0e3f\u0e3f\u0e3f"),r.a.createElement(j.a,{value:4},"\u0e3f\u0e3f\u0e3f\u0e3f"),r.a.createElement(j.a,{value:-1},"No Preference"))),r.a.createElement("p",null),r.a.createElement(f.a,{control:r.a.createElement(v.a,{checked:ee,onChange:function(e){ae(e.target.checked)}}),label:"Prefer nearby"}),r.a.createElement("p",null),r.a.createElement("h4",null,"Favorite Categories"),r.a.createElement(u.a,{component:"fieldset"},r.a.createElement(S.a,null,ye),!Oe&&r.a.createElement(s.a,{onClick:function(){return Se(!0)},startIcon:r.a.createElement(I.a,null)},"Show more"),Oe&&r.a.createElement(s.a,{onClick:function(){return Se(!1)},startIcon:r.a.createElement(R.a,null)},"Show less"))),r.a.createElement("p",null),r.a.createElement(s.a,{onClick:function(){if(""!==W)alert(W);else{var e=[];if(""===L&&e.push("Username"),""===K&&e.push("Gender"),V||e.push("Birthdate"),""===q&&e.push("Prefer Price"),e.length>0)alert("Please fill in theres fields: ".concat(e.join(", ")));else{n(!1);var a={username:L,profile:{gender:K,birthdate:V,preference:{categories:le,price_range:q,prefer_nearby:ee}}};P.a.post("".concat(x.appServerUrl,"/api/users"),a).then((function(e){"username"in e.data?(T.a.set("username",e.data.username),window.location.reload()):(alert("Error creating new user"),n(!0))})).catch((function(e){alert(e.response),n(!0)}))}}},variant:"contained",color:"primary"},"Register"),r.a.createElement("p",null,"\xa0")):r.a.createElement(E.a,null))},G=t(149),L=t(185),D=t(186),F=t(187),M=t(188),K=t(203),N=t(189),A=t(93),H=t.n(A),V=t(92),J=t.n(V),$=t(89),Z=t.n($),q=t(90),Q=t.n(q),X=t(91),Y=t.n(X),ee=t(94),ae=t.n(ee),te=t(95),ne=t.n(te),le=function(e){return r.a.createElement(g.a,{display:"flex",alignItems:"center"},r.a.createElement(g.a,{width:"100%",mr:1},r.a.createElement(E.a,Object.assign({variant:"determinate"},e))),r.a.createElement(g.a,{minWidth:35},r.a.createElement(G.a,{variant:"body2",color:"textSecondary"},e.label)))},re=function(e){var a,t,n,c=Object(l.useState)("Getting start."),o=Object(i.a)(c,2),u=o[0],m=o[1],d=Object(l.useState)(null),p=Object(i.a)(d,2),f=p[0],v=p[1],g=Object(l.useState)(null),h=Object(i.a)(g,2),b=h[0],O=h[1],j=Object(l.useState)(null),S=Object(i.a)(j,2),y=S[0],_=S[1],k=Object(l.useState)([]),C=Object(i.a)(k,2),w=C[0],U=C[1],W=Object(l.useState)(0),R=Object(i.a)(W,2),z=R[0],I=R[1];Object(l.useEffect)((function(){m("Getting current location"),"geolocation"in navigator?navigator.geolocation.getCurrentPosition((function(a){O([a.coords.longitude,a.coords.latitude]),console.log(a.coords),m("Getting recommendations"),P.a.post("".concat(x.appServerUrl,"/api/recommendations"),{users:[e.user._id],location:{type:"Point",coordinates:[a.coords.longitude,a.coords.latitude]}}).then((function(e){console.log(e.data),v(e.data.recommendations),_(e.data.token),m("")}))})):alert("Geolocation is disabled")}),[e.user._id]);var B=function(e,a){var t={restaurant:e,is_love:a,timestamp:Date.now()};w.push(t),U(w);var n=z+1;I(n),n>=f.length&&(console.log("finish!"),console.log(w),P.a.post("".concat(x.appServerUrl,"/api/recommendations"),{token:y,histories:w}).then((function(e){v(e.data.recommendations)})))},G=r.a.createElement(L.a,{container:!0,direction:"column",alignItems:"center"},r.a.createElement(Z.a,{style:{fontSize:100},color:"secondary"}),r.a.createElement("h3",null,"Thank you."),r.a.createElement(s.a,{onClick:function(){I(0)},variant:"contained",color:"primary"},"More")),A=r.a.createElement("div",null,f&&z<f.length&&r.a.createElement("div",null,r.a.createElement(le,{variant:"determinate",value:(z+1)/f.length*100,label:"".concat(z+1,"/").concat(f.length)}),r.a.createElement("p",null),r.a.createElement(D.a,null,f[z].cover_url&&r.a.createElement(F.a,{component:"img",image:f[z].cover_url,title:"Contemplative Reptile",height:"160"}),r.a.createElement(M.a,null,r.a.createElement("h2",{style:{marginBottom:"0px",marginTop:"5px"}},null!==(a=f[z].name)&&void 0!==a?a:""),r.a.createElement("p",{style:{fontSize:"10px",color:"gray",marginBottom:"30px"}},f[z].address),r.a.createElement("div",null,f[z].profile.categories.map((function(e){var a=e._id,t=e.name_en;return r.a.createElement(K.a,{key:a,style:{marginBottom:"5px",marginRight:"10px"},label:t})}))),r.a.createElement("div",null,r.a.createElement("p",null,r.a.createElement("strong",null,null!==(t="".concat((f[z].dist.calculated/1e3).toFixed(2)," km"))&&void 0!==t?t:"","\xa0\xa0\xa0\xa0\xa0"),-1!==f[z].profile.price_range&&r.a.createElement("span",null,"\u0e3f".repeat(f[z].profile.price_range),"\xa0\xa0\xa0\xa0\xa0"),f[z].profile.rating&&r.a.createElement("span",null,r.a.createElement(Q.a,{style:{fontSize:14}})," ",f[z].profile.rating,"\xa0\xa0\xa0\xa0\xa0"),f[z].profile.likes&&r.a.createElement("span",null,r.a.createElement(Y.a,{style:{fontSize:14}})," ",f[z].profile.likes)))),r.a.createElement(N.a,null,r.a.createElement(L.a,{container:!0},r.a.createElement(L.a,{item:!0,xs:6},r.a.createElement(s.a,{fullWidth:!0,onClick:function(){return B(f[z]._id,!1)},size:"large",color:"secondary",startIcon:r.a.createElement(J.a,null)},r.a.createElement("strong",null,"Nah"))),r.a.createElement(L.a,{item:!0,xs:6},r.a.createElement(s.a,{fullWidth:!0,onClick:function(){return B(f[z]._id,!0)},size:"large",color:"primary",startIcon:r.a.createElement(H.a,null)},r.a.createElement("strong",null,"Love"))))))),f&&z>=f.length&&r.a.createElement("div",null,G));return r.a.createElement("div",null,r.a.createElement(L.a,{container:!0,direction:"row",justify:"space-between"},r.a.createElement("h3",null,"Hi, ",null!==(n=e.user.username)&&void 0!==n?n:""),r.a.createElement(s.a,{onClick:function(){T.a.remove("username"),window.location.reload()},size:"small",color:"secondary"},"Logout")),b?r.a.createElement("div",{style:{color:"gray"}},r.a.createElement(ae.a,{style:{fontSize:"14px"}})," ",b[1].toFixed(6),", ",b[0].toFixed(6)):r.a.createElement(ne.a,{style:{fontSize:"14px"}}),r.a.createElement("p",null),u?r.a.createElement("div",null,r.a.createElement("p",null,u),r.a.createElement(E.a,null)):r.a.createElement("div",null,A),r.a.createElement("p",null))},ce=t(97),oe=t(190),ie=Object(ce.a)({palette:{primary:{light:"#ffa040",main:"#ff6f00",dark:"#c43e00",contrastText:"#fff"},secondary:{light:"#63a4ff",main:"#1976d2",dark:"#004ba0",contrastText:"#fff"}}}),ue=function(){var e=Object(l.useState)(!1),a=Object(i.a)(e,2),t=a[0],n=a[1],c=Object(l.useState)(null),o=Object(i.a)(c,2),p=o[0],f=o[1],v=Object(l.useState)(""),g=Object(i.a)(v,2),h=g[0],b=g[1],O=Object(l.useState)(!1),j=Object(i.a)(O,2),S=j[0],y=j[1];Object(l.useEffect)((function(){var e=T.a.get("username");e?_(e):n(!0)}),[]);var _=function(e){P.a.post("".concat(x.appServerUrl,"/api/auth"),{username:e}).then((function(e){var a=e.data;a.status?(T.a.set("username",a.data.username),f(a.data),n(!0)):(alert(a.error),n(!0))})).catch((function(e){alert(e)}))},k=r.a.createElement("div",null,r.a.createElement("h3",null,"Please login"),r.a.createElement(u.a,{fullWidth:!0},r.a.createElement(m.a,{onChange:function(e){b(e.target.value)},variant:"outlined",label:"Username"})),r.a.createElement(s.a,{onClick:function(){n(!1),console.log(x),_(h)},style:{marginTop:"10px"},variant:"contained",color:"primary"},"Login"),r.a.createElement("h4",null,"or"),r.a.createElement(s.a,{onClick:function(){return y(!0)},variant:"contained",color:"primary"},"Register"));return r.a.createElement("div",null,r.a.createElement(oe.a,{theme:ie},r.a.createElement(d.a,{component:"main",maxWidth:"xs"},r.a.createElement("h1",null,"Resteraunt Recommender"),t?r.a.createElement("div",null,!S&&!p&&k,S&&r.a.createElement("div",null,r.a.createElement(s.a,{onClick:function(){return y(!1)},color:"primary"},"Login"),r.a.createElement(B,null)),p&&r.a.createElement(re,{user:p,name:p.username})):r.a.createElement(E.a,null))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(ue,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[120,1,2]]]);
//# sourceMappingURL=main.aca742f4.chunk.js.map